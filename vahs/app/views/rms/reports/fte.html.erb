<%= javascript_include_tag 'reports.tab.js' %>

<% cur_date = Date.today.strftime("%m/%d/%y") %>
<% cur_pp = @cur_pp.first.payperiod %>
<% next_pp = @next_pp.first.payperiod %>
<% cur_enddate = @cur_pp.first.enddate.strftime("%m/%d/%y") %>
<% next_startdate = @next_pp.first.startdate %>
<% loss_date = @cur_pp.first.enddate + 1.weeks %>
<% eod_date = next_startdate.next_week(day = :monday) %>
<% ttl_fte = @empftes.sum(:fte) %>

<h3 align="center">Latest FTE Report</h3>
<style>
.headers{
  font-size: 150%;
  font-weight: bold;
  text-align: center;
}
</style>

<div class="headers">
Pay Period <%= cur_pp %> Ended <%= cur_enddate %>
<br>
<br>
</div>

<div id="fteResults" class="wrapper">
   <table class="table table-condensed employeetable">
      <thead class="thead-inverse">
      <tr>
         <th>Grade</th>
         <th>Step</th>
         <th>Name</th>
         <th>Hours</th>
         <th>FTE</th>
         <% @empftes.each do |row| %>
            <tr>
            <td><%= row.grade %></td>
            <td><%= row.step %></td>
            <td><%= row.name %></td>
            <td><%= row.fte*80 %></td>
            <td><%= row.fte %></td>
         <% end %>

         <tr class="rptTotals">
            <td></td>
		 <td></td>
            <td class="rghtAlign"> Total FTE</td>
		 <td></td>
            <td class="rghtAlign"><%= ttl_fte %></td>    
        </tr>
      </tbody>
   </table>
</div>

<br>
<br>
<div class="headers">
   New Hires Added Pay Period <%= next_pp %> <%= " EOD " %>
   <%= eod_date.strftime("%m/%d/%y")  %>
   <% ttl_nh_fte = 0 %>
   <% ttl_nh_emp = 0 %>
</div>

<div id="ftenewhires" class="wrapper">
   <table class="table table-condensed employeetable">
      <thead class="thead-inverse">
      <tr>
         <th>Grade</th>
         <th>Step</th>
         <th>Name</th>
         <th>Hours</th>
         <th>FTE</th>
         <% @fte_new_hires.each do |row| %>
            <tr>
            <td><%= row.grade %></td>
            <td><%= row.step %></td>
            <td><%= row.name %></td>
            <td><%= 80.0 %></td>
            <td><%= 1.0 %></td>
         <% end %>    
        </tr>
      </tbody>
   </table>
</div>


<br>
<br>
<div class="headers">
   Losses Subtracted Pay Period <%= next_pp %> as of 
   <%= loss_date.strftime("%m/%d/%y") %>
</div>

<div id="ftelosses" class="wrapper">
   <table class="table table-condensed employeetable">
      <thead class="thead-inverse">
      <tr>
         <th>Grade</th>
         <th>Step</th>
         <th>Name</th>
         <th>Hours</th>
         <th>FTE</th>
         <% @fte_losses.each do |row| %>
            <tr>
            <td><%= row.grade %></td>
            <td><%= row.step %></td>
            <td><%= row.name %></td>
            <td><%= 80.0 %></td>
            <td><%= 1.0 %></td>
         <% end %>    
        </tr>
      </tbody>
   </table>
</div>

<br>
<br>
<div class="headers">
   Total FTE as of <%= cur_date %> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<%= ttl_fte + @fte_new_hires.count - @fte_losses.count %> 
<br>
<br>
   Total Employees on board as of <%= cur_date %> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
   <%= @empftes.count + @fte_new_hires.count - @fte_losses.count %>
</div>


<br>
<div id="content" class="container">
   <div class="group">
      <%= field_set_tag "Export Format:" do %>
      <%= radio_button_tag :export_format, "HTML", true %>
      <%= label_tag :export_format_HTML, "HTML", class: 'radio-tag' %>

      <%= radio_button_tag :export_format, "MS Excel" %>
      <%= label_tag :export_format_MS_Excel, "MS Excel", class: 'radio-tag' %>

      <%= radio_button_tag :export_format, "PDF" %>
      <%= label_tag :export_format_PDF, "PDF", class: 'radio-tag' %>
      <% end %>

      <span class="subtext">Select Export Format</span>
    </div>

   <div class="button">
      <%= field_set_tag do %>
      <%= button_tag "Export Report" %>
      <% end %>
    </div>
</div>

